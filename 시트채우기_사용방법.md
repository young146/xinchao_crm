# 📝 고객관리 시트 자동 채우기 - 사용 방법

## 🎯 목적
**첫 번째 파일** (ADVERTISEMENT DETAILS)의 데이터를 변환해서  
**두 번째 파일** (고객관리 시트 - 빈 템플릿)에 자동으로 채워넣기

---

## 🚀 빠른 시작 (3단계)

### 1단계: 앱 실행
```bash
cd c:\xinchao_crm
npm start
```

### 2단계: "📝 시트 채우기" 탭 클릭
- 브라우저에서 `http://localhost:3000` 접속
- **"📝 시트 채우기 (추천)"** 탭 선택

### 3단계: 데이터 변환 및 복사
1. **"🔄 데이터 변환 시작"** 버튼 클릭
2. 변환 완료 알림 확인
3. **"📋 Google Sheets에 복사"** 버튼 클릭

---

## 📋 방법 A: 클립보드 복사 (추천)

가장 간단한 방법입니다!

### 단계별 가이드

**1. 데이터 변환**
```
"🔄 데이터 변환 시작" 버튼 클릭
→ 잠시 대기
→ "✅ 변환 완료!" 메시지 확인
```

**2. 클립보드에 복사**
```
"📋 Google Sheets에 복사" 버튼 클릭
→ "클립보드에 복사되었습니다!" 메시지 확인
```

**3. 두 번째 파일 열기**
```
고객관리 시트 (빈 템플릿) 열기
→ A3 셀 선택 (데이터를 넣을 첫 번째 셀)
→ Ctrl + V (붙여넣기)
```

**4. 완료!** 🎉
- 모든 데이터가 자동으로 채워집니다
- Vol 550~574 컬럼도 자동으로 채워집니다
- 금액 계산도 완료됩니다

---

## ⚙️ 방법 B: Google Apps Script (자동화)

한 번만 설정하면 버튼 클릭으로 실행 가능!

### 단계별 가이드

**1. Apps Script 코드 복사**
```
"⚙️ Apps Script 생성" 버튼 클릭
→ 코드가 자동으로 클립보드에 복사됨
```

**2. 고객관리 시트에서 Apps Script 열기**
```
두 번째 파일(고객관리 시트) 열기
→ 상단 메뉴: 확장 프로그램 > Apps Script
→ 새 프로젝트 생성됨
```

**3. 코드 붙여넣기**
```
기본 코드 삭제
→ Ctrl + V (복사한 코드 붙여넣기)
→ Ctrl + S (저장)
→ 프로젝트 이름: "고객관리시트 자동채우기"
```

**4. 함수 실행**
```
상단에서 "fillCustomerData" 함수 선택
→ 실행 버튼(▶) 클릭
→ 권한 승인 (처음만)
→ "✅ 데이터 추가 완료!" 메시지
```

**5. 완료!** 🎉
- 자동으로 모든 데이터가 채워집니다
- 다음부터는 함수만 실행하면 됩니다

---

## 📊 변환되는 데이터

### ✅ 자동으로 채워지는 항목

| 원본 (ADVERTISEMENT DETAILS) | → | 고객관리 시트 |
|------------------------------|---|-------------|
| CUSTOMER | → | 업체명 |
| Address | → | 주소 |
| Tel (앞) | → | 전화번호 |
| Tel (뒤) | → | 모바일 |
| Size | → | 광고 사이즈 + 고객 유형 |
| Price | → | 단가 |
| Remarks (552~557) | → | 시작 호수: 552, 종료 호수: 557 |
| 자동 계산 | → | Vol 552~557 각 셀에 단가 입력 |
| 자동 계산 | → | 총 계약 금액 = 단가 × 호수 |
| Have collect | → | 누적 미수금 |

### ❌ 수동 입력 필요 항목

다음 항목은 변환 후 **직접 입력**해야 합니다:
- 업종
- 대표자
- 담당자
- 이메일
- 카카오톡
- 온라인 병행 단가
- 온라인 기간
- 온라인 총액
- 시작일 (날짜)
- 종료일 (날짜)
- 계산서 발행

---

## 🔍 데이터 확인 체크리스트

변환 후 반드시 확인하세요:

```
✅ 업체명이 올바르게 들어갔는가?
✅ 전화번호와 모바일이 분리되었는가?
✅ 호수 범위가 정확한가?
✅ Vol 컬럼이 올바르게 채워졌는가?
✅ 총 계약 금액이 맞는가?
✅ 미수금이 정확한가?
✅ 고객 유형이 올바른가? (FC=대형, 1/2=중형, etc)
```

---

## 💡 예시

### 입력 (ADVERTISEMENT DETAILS)
```
No: 1
CUSTOMER: Awesome Academy
Address: 204B/1 Nguyen Van Huong st., An Khanh ward, HCMC
Tel: 093 888 5891
Page No: 16
Size: FC
Price: $450
Received: $450
Have collect: $0
Remarks: 552~557
```

### 출력 (고객관리 시트)
```
고객 유형: 대형광고주
업체명: Awesome Academy
주소: 204B/1 Nguyen Van Huong st., An Khanh ward, HCMC
전화번호: 093 888 5891
모바일: (빈칸)
광고 사이즈: FC
시작 호수: 552
종료 호수: 557
단가: $450
총 계약 금액: $2,700
Vol 552: $450
Vol 553: $450
Vol 554: $450
Vol 555: $450
Vol 556: $450
Vol 557: $450
Vol 558: (빈칸)
누적 미수금: $0
```

**계산:**
- 총 계약 금액 = $450 × (557 - 552 + 1) = $450 × 6 = $2,700
- Vol 552~557 범위에 각각 $450 입력

---

## ⚠️ 주의사항

### 데이터 백업
- **중요:** 기존 데이터가 있다면 먼저 백업하세요!
- 방법: 파일 → 사본 만들기

### 셀 위치
- **A3 셀**부터 붙여넣기 (A1, A2는 헤더)
- 기존 데이터를 덮어쓰지 않도록 주의

### 데이터 검증
- 붙여넣기 후 상위 10~20개 행 확인
- 금액, 호수, 연락처 등 중요 필드 체크

---

## 🚨 문제 해결

### ❓ "변환 중 오류 발생"
**원인:** Google Sheets 접근 권한  
**해결:**
1. 첫 번째 파일이 "공개" 또는 "링크가 있는 모든 사용자"로 설정되어 있는지 확인
2. 인터넷 연결 확인

### ❓ 복사했는데 시트에 붙여넣기가 안 됨
**원인:** 클립보드 권한  
**해결:**
1. 브라우저에서 클립보드 권한 허용
2. 또는 방법 B (Apps Script) 사용

### ❓ 데이터가 이상하게 들어감 (컬럼이 밀림)
**원인:** CSV 쉼표 파싱 문제  
**해결:** 이미 TSV(탭 구분) 형식으로 수정되어 있음 - 앱 재시작

### ❓ Vol 컬럼이 비어있음
**원인:** 호수 정보 없음  
**해결:** Remarks 필드에 "숫자~숫자" 형식 확인 (예: "552~557")

### ❓ 한글이 깨짐
**원인:** 인코딩 문제  
**해결:** Google Sheets는 자동으로 UTF-8 인식 (문제 없음)

---

## 📞 추가 지원

- **상세 가이드:** `README_데이터변환가이드.md`
- **빠른 참조:** `데이터변환_치트시트.md`
- **매핑 규칙:** `data-mapping-guide.md`

---

## 🎬 전체 프로세스 요약

```
1. npm start
   ↓
2. "📝 시트 채우기" 탭 클릭
   ↓
3. "🔄 데이터 변환 시작" 버튼 클릭
   ↓
4. "📋 Google Sheets에 복사" 버튼 클릭
   ↓
5. 고객관리 시트 열기
   ↓
6. A3 셀 선택
   ↓
7. Ctrl + V (붙여넣기)
   ↓
8. ✅ 완료!
```

**소요 시간:** 약 2분

---

**💾 이 파일을 인쇄하거나 바탕화면에 저장해두세요!**
