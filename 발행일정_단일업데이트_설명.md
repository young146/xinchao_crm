# ✅ 발행 일정 단일 업데이트 시스템

## 🎯 핵심: 한 파일만 수정하면 끝!

```
volumeSchedule.js (발행 일정)
       ↓
자동으로 모든 파일에 적용
       ↓
┌──────────────┬──────────────┬──────────────┐
│ contractStatus│ CustomerCard │ VolumeSchedule│
│   (현재 Vol) │  (계약 날짜) │  (일정 UI)   │
└──────────────┴──────────────┴──────────────┘
```

---

## 📁 수정이 필요한 파일: **단 1개**

### `src/utils/volumeSchedule.js`
```javascript
export const VOLUME_SCHEDULE = {
  553: { date: "2026-02-05", status: "published" },
  554: { date: "2026-02-20", status: "planned" },  // ← 여기만 수정!
  555: { date: "2026-03-05", status: "planned" },
  // ...
};
```

---

## 🔄 자동 적용되는 모든 곳

### 1. **현재 볼륨 자동 계산**
```javascript
// src/utils/contractStatus.js
import { getCurrentVolume } from './volumeSchedule';

export const CURRENT_VOLUME = getCurrentVolume();
// ↑ volumeSchedule.js의 데이터로 자동 계산
```

### 2. **고객 카드 - 계약 날짜**
```javascript
// src/components/CustomerCard.js
import { getContractDates, getVolumeRangeDates } from '../utils/volumeSchedule';

const contractDates = getContractDates(552, 557);
// ↑ 자동으로 최신 일정 사용
// 결과: { startDate: "2026-01-20", endDate: "2026-04-02" }
```

### 3. **발행 일정 UI**
```javascript
// src/components/VolumeSchedule.js
import { VOLUME_SCHEDULE, getCurrentVolume } from '../utils/volumeSchedule';

const currentVol = getCurrentVolume();
// ↑ 자동으로 현재 볼륨 계산
// VOLUME_SCHEDULE 직접 참조로 일정 표시
```

### 4. **대시보드 - 계약 상태**
```javascript
// src/App.js
import { getContractStatus, getPaymentStatus } from './utils/contractStatus';

// getContractStatus는 내부적으로 getCurrentVolume() 사용
const status = getContractStatus(startVol, endVol);
// ↑ volumeSchedule.js의 데이터로 자동 판단
```

---

## ⚙️ 실제 업데이트 과정

### 상황: Vol 554가 오늘 발행됨 (2026.02.20)

#### Step 1: volumeSchedule.js 수정
```javascript
// src/utils/volumeSchedule.js

// 수정 전
554: { date: "2026-02-20", status: "planned" },

// 수정 후
554: { date: "2026-02-20", status: "published" }, // ← planned → published
```

#### Step 2: 저장 후 앱 재시작
```bash
# 터미널에서
npm start
```

#### Step 3: 자동 적용 확인 ✅

##### ✅ 대시보드
```
[현재 볼륨]
Vol 554 (자동으로 553 → 554로 변경됨)
```

##### ✅ 고객 카드 - Pet Like Park (Vol 549~554)
```
계약 상태: "계약 만료" (554가 발행되어 만료됨)
📅 종료 날짜: 2026.02.20

호수별 현황:
[Vol 549 ✓] ... [Vol 554 ✓] ← 자동으로 ✓ 표시
```

##### ✅ 발행 일정 탭
```
📖 현재 발행 중: Vol 554
📆 다음 발행 예정: Vol 555 (13일 후)

2월 발행 일정:
- Vol 553: 2026.02.05 ✓
- Vol 554: 2026.02.20 ✓ ← 자동으로 ✓ 표시
```

##### ✅ 계약 상태 판정
```
고객: Awesome Academy (Vol 552~557)

이전 (Vol 553 기준):
- 상태: "광고 게재 중"
- 남은 호수: 5개

현재 (Vol 554 기준, 자동 업데이트):
- 상태: "광고 게재 중"
- 남은 호수: 4개 ← 자동으로 1개 감소
```

---

## 🔍 자동 적용 원리

### 중앙 집중식 데이터 관리
```
volumeSchedule.js (단일 진실의 원천)
       ↓
    import
       ↓
┌──────────────────────────────────┐
│ 모든 컴포넌트가 같은 데이터 참조 │
└──────────────────────────────────┘
       ↓
  데이터 변경
       ↓
  모든 곳에 자동 반영
```

### 코드 흐름 예시
```javascript
// 1. volumeSchedule.js (데이터 저장소)
export const VOLUME_SCHEDULE = {
  554: { date: "2026-02-20", status: "published" }
};

// 2. getCurrentVolume() 함수 (자동 계산)
export const getCurrentVolume = () => {
  const today = new Date();
  // VOLUME_SCHEDULE를 읽어서 현재 볼륨 자동 계산
  return 554; // 2026.02.20 기준
};

// 3. contractStatus.js (자동 import)
import { getCurrentVolume } from './volumeSchedule';
export const CURRENT_VOLUME = getCurrentVolume(); // 554 (자동)

// 4. CustomerCard.js (자동 적용)
import { getContractDates } from '../utils/volumeSchedule';
const dates = getContractDates(552, 557);
// 자동으로 최신 일정으로 계산됨

// 5. VolumeSchedule.js (자동 표시)
import { VOLUME_SCHEDULE } from '../utils/volumeSchedule';
// 자동으로 최신 일정 표시
```

---

## 📋 체크리스트

### 새 호 발행 시 (예: Vol 555)

```
[ ] 1. volumeSchedule.js 파일 열기
[ ] 2. 해당 호수 찾기 (555)
[ ] 3. status 변경: "planned" → "published"
[ ] 4. 파일 저장 (Ctrl+S)
[ ] 5. 앱 재시작 (npm start)
[ ] 6. 자동 적용 확인:
    [ ] 대시보드: 현재 Vol 555로 표시
    [ ] 고객 카드: 계약 상태 자동 업데이트
    [ ] 발행 일정: Vol 555 "발행됨 ✓" 표시
    [ ] 결제 패턴: 자동 재계산
```

---

## ⚠️ 주의사항

### ❌ 이렇게 하지 마세요
```
contractStatus.js에서 CURRENT_VOLUME 수동 변경 ✗
CustomerCard.js에서 날짜 하드코딩 ✗
App.js에서 계약 상태 직접 입력 ✗
```

### ✅ 이렇게 하세요
```
volumeSchedule.js에서만 수정 ✓
나머지는 자동으로 적용됨 ✓
```

---

## 🔧 실전 예시

### 예시 1: Vol 555 발행 (2026.03.05)

#### 수정 전
```javascript
// volumeSchedule.js
555: { date: "2026-03-05", status: "planned" },
```

#### 수정 후
```javascript
// volumeSchedule.js
555: { date: "2026-03-05", status: "published" }, // ← 이것만 변경
```

#### 자동 적용 결과
```
✅ contractStatus.js
   CURRENT_VOLUME: 554 → 555 (자동)

✅ 대시보드 통계
   - "광고 게재 중": 자동 재계산
   - "계약 만료": 자동 증가 (Vol 554 종료 고객들)

✅ 고객 카드 (Pet Like Park, Vol 549~554)
   - 상태: "광고 게재 중" → "계약 만료" (자동)
   - 호수별 현황: Vol 554까지 ✓ 표시

✅ 결제 패턴 (Awesome Academy, Vol 552~557)
   - 발행 호수: 2개 → 3개 (자동)
   - 기대 수금: $900 → $1,350 (자동 재계산)
   - 선불/지연 판정 자동 업데이트

✅ 발행 일정 탭
   - 현재: Vol 554 → Vol 555 (자동)
   - 다음: Vol 555 → Vol 556 (자동)
```

---

## 🎯 핵심 요약

### 질문: "발행 일정을 확인한 후 입력하면 자동으로 모든 파일에 적용되는가?"

### 답변: **예! 100% 자동 적용됩니다.**

```
1개 파일만 수정
(volumeSchedule.js)
       ↓
자동으로 모든 곳에 적용
       ↓
┌────────────────┬────────────────┬────────────────┐
│ 현재 볼륨      │ 계약 상태      │ 결제 패턴      │
│ (자동 계산)    │ (자동 판정)    │ (자동 분석)    │
├────────────────┼────────────────┼────────────────┤
│ 고객 카드      │ 발행 일정 UI   │ 대시보드 통계  │
│ (자동 표시)    │ (자동 업데이트)│ (자동 집계)    │
└────────────────┴────────────────┴────────────────┘
```

---

## 💡 추가 혜택

### 1. 데이터 일관성 보장
```
모든 곳에서 같은 데이터 사용
→ 불일치 오류 없음
→ 수동 동기화 불필요
```

### 2. 유지보수 용이
```
1개 파일만 관리
→ 실수 최소화
→ 업데이트 간편
```

### 3. 자동 계산
```
현재 볼륨 자동 계산
→ 수동 입력 불필요
→ 오늘 날짜 기준 자동 판단
```

---

## 🚀 실제 작업 흐름

### 매월 초 (새 호 발행 시)

```bash
# 1. 파일 열기
code src/utils/volumeSchedule.js

# 2. 해당 호수 찾아서 수정
# 554: { date: "2026-02-20", status: "published" }

# 3. 저장
Ctrl + S

# 4. 앱 재시작
npm start

# 5. 확인
브라우저에서 자동 적용 확인
✅ 현재 Vol: 554
✅ 고객 계약 상태: 자동 업데이트
✅ 발행 일정: Vol 554 "발행됨 ✓"
```

---

## 📊 적용 범위

### 자동 적용되는 모든 기능

1. **현재 볼륨 계산** ✅
2. **계약 상태 판정** (게재 중/만료/예정) ✅
3. **결제 패턴 분석** (선불/지연/연체) ✅
4. **계약 날짜 표시** (시작/종료일) ✅
5. **호수별 발행일** (고객 카드) ✅
6. **발행 일정 UI** (월별 캘린더) ✅
7. **다음 발행 예정** (며칠 후) ✅
8. **대시보드 통계** (게재 중/연체 등) ✅
9. **미수금 계산** (발행분 vs 수금분) ✅
10. **계약 진행률** (프로그레스 바) ✅

---

## 🎨 비교: 수동 vs 자동

### ❌ 수동 업데이트 (이전 방식)
```
contractStatus.js: CURRENT_VOLUME = 555 수동 입력
CustomerCard.js: 날짜 계산 로직 수정
VolumeSchedule.js: 일정 데이터 수정
App.js: 통계 계산 로직 수정
...
→ 5~10개 파일 수정 필요
→ 불일치 위험
→ 실수 가능성 높음
```

### ✅ 자동 업데이트 (현재 방식)
```
volumeSchedule.js: 1줄만 수정
  status: "planned" → "published"

→ 1개 파일만 수정
→ 모든 곳에 자동 반영
→ 실수 불가능
```

---

## 🔐 안전성

### 단일 진실의 원천 (Single Source of Truth)
```
volumeSchedule.js = 유일한 데이터 소스
       ↓
모든 컴포넌트는 읽기만 함
       ↓
데이터 무결성 보장
```

### 타입 안전성
```javascript
// 잘못된 형식은 자동으로 감지됨
554: { date: "2026-02-30" } // ❌ 존재하지 않는 날짜
→ 앱 실행 시 오류 발생 (조기 감지)
```

---

**💡 결론: `volumeSchedule.js` 파일 하나만 수정하면 모든 곳에 자동으로 적용됩니다!**
