# ➕ 새 고객 추가 - 사용 방법

## ✨ 새로운 기능

이제 앱에서 직접 **새 고객을 추가**할 수 있습니다!

---

## 🎯 사용 방법

### 방법 A: 클립보드 복사 (추천) 📋

가장 간단하고 빠른 방법입니다!

#### 1단계: 새 고객 추가 버튼 클릭
```
"📊 데이터 보기" 탭 → 검색 바 옆 "➕ 새 고객 추가" 버튼 클릭
```

#### 2단계: 정보 입력
**필수 항목:**
- ✅ 업체명
- ✅ 전화번호 또는 모바일 (둘 중 하나)
- ✅ 단가 (USD)
- ✅ 광고 사이즈 (FC, 1/2, 1/4, Yellow Page, Flea Market)

**선택 항목:**
- 주소
- 페이지 번호
- 시작/종료 호수 (입력하면 자동으로 총 금액 계산)
- 비고

#### 3단계: 클립보드에 복사
```
"📋 클립보드에 복사 (추천)" 버튼 클릭
→ "복사되었습니다!" 메시지 확인
```

#### 4단계: Google Sheets에 붙여넣기
```
1. ADVERTISEMENT DETAILS 시트 열기
2. 마지막 고객 데이터의 다음 행 선택 (예: 102번 행)
3. Ctrl + V (붙여넣기)
4. A 컬럼(No.)에 번호 수동 입력 (예: 102)
5. 완료!
```

#### 5단계: 앱 새로고침
```
React 앱에서 Ctrl + R (새로고침)
→ 새 고객이 테이블에 나타남
```

---

### 방법 B: Google Apps Script 자동 추가 ⚙️

한 번만 설정하면 버튼 클릭으로 자동 추가!

#### 1단계: Apps Script 설정

**Google Sheets에서:**
```
1. ADVERTISEMENT DETAILS 시트 열기
2. 확장 프로그램 > Apps Script
3. 새 프로젝트 생성됨
```

**코드 추가:**
```
1. GoogleAppsScript_자동추가.gs 파일 열기 (프로젝트 폴더에 있음)
2. 전체 코드 복사 (Ctrl + A, Ctrl + C)
3. Apps Script 에디터에 붙여넣기 (Ctrl + V)
4. 저장 (Ctrl + S)
5. 프로젝트 이름: "Xinchao CRM 자동추가"
```

#### 2단계: 웹 앱 배포

```
1. 배포 > 새 배포
2. 유형 선택: "웹 앱"
3. 설정:
   - 설명: "새 고객 자동 추가 API"
   - 실행 사용자: "나"
   - 액세스 권한: "모든 사용자"
4. 배포 클릭
5. 권한 승인 (처음만)
6. ⚠️ 웹 앱 URL 복사 (중요!)
   예: https://script.google.com/macros/s/ABC123.../exec
```

#### 3단계: React 앱에 URL 설정

**AddCustomerForm.js 수정:**
```javascript
// 파일 위치: src/components/AddCustomerForm.js
// 찾기: const APPS_SCRIPT_URL = "";
// 수정: const APPS_SCRIPT_URL = "복사한 웹 앱 URL";

const APPS_SCRIPT_URL = "https://script.google.com/macros/s/YOUR_URL/exec";
```

#### 4단계: 자동 추가 사용

```
1. "➕ 새 고객 추가" 버튼 클릭
2. 정보 입력
3. "⚙️ 자동 추가" 버튼 클릭
4. 잠시 대기 (3-5초)
5. "추가 완료!" 메시지 확인
6. 앱 새로고침 (Ctrl + R)
```

---

## 📋 입력 항목 상세

### 필수 항목 (*)

#### 업체명 *
```
예: Awesome Academy
설명: 고객사 이름
```

#### 전화번호 또는 모바일 *
```
예: 028 1234 5678 (전화번호)
    090 123 4567 (모바일)
설명: 둘 중 하나는 필수
     둘 다 입력하면 자동으로 "전화; 모바일" 형식으로 합쳐짐
```

#### 단가 (USD) *
```
예: 450
설명: 호당 광고 단가
     $ 기호 없이 숫자만 입력
```

#### 광고 사이즈 *
```
선택지:
- FC (대형광고주)
- 1/2 (중형광고주)
- 1/4 (소형광고주)
- Yellow Page (옐로우페이지)
- Flea Market (프리마켓)
```

### 선택 항목

#### 주소
```
예: 204B/1 Nguyen Van Huong st., An Khanh ward, HCMC
설명: 사업장 주소
```

#### 페이지 번호
```
예: 16
설명: 매거진 내 광고 페이지 번호
```

#### 시작 호수 / 종료 호수
```
예: 시작 550, 종료 557
설명: 광고 게재 시작/종료 호수
     입력하면 자동으로:
     - 계약 기간 계산 (557 - 550 + 1 = 8개 호)
     - 총 금액 계산 ($450 × 8 = $3,600)
     - 비고에 "550~557" 자동 입력
```

#### 비고
```
예: monthly~Jul'26
    552~557
설명: 추가 메모
     호수를 입력하지 않았다면 여기에 수동 입력
```

---

## 💡 자동 계산 기능

### 총 계약 금액
```
공식: 단가 × (종료 호수 - 시작 호수 + 1)

예시:
단가: $450
시작: 552
종료: 557
계산: $450 × (557 - 552 + 1) = $450 × 6 = $2,700
```

### 초기 미수금
```
기본값: 단가와 동일 (아직 수금 전이므로)

예시:
단가: $450
초기 미수금: $450
수금 완료: $0
```

### 전화번호 결합
```
전화: 028 1234 5678
모바일: 090 123 4567
결과: "028 1234 5678; 090 123 4567"
```

---

## ✅ 유효성 검사

입력 시 자동으로 검사되는 항목:

```
✅ 업체명은 필수입니다
✅ 전화번호 또는 모바일 중 하나는 필수입니다
✅ 단가는 0보다 커야 합니다
✅ 시작 호수는 종료 호수보다 작아야 합니다
```

에러가 있으면 빨간색으로 표시됩니다.

---

## 🎨 화면 예시

### 새 고객 추가 폼

```
╔════════════════════════════════════════════╗
║  ➕  새 고객 추가                    [X]  ║
║      필수 정보를 입력하고 추가하세요        ║
╠════════════════════════════════════════════╣
║                                            ║
║ 📋 기본 정보                               ║
║ ─────────────────────────────────────────║
║ 업체명 *                                   ║
║ [Awesome Academy                        ] ║
║                                            ║
║ 주소                                       ║
║ [204B/1 Nguyen Van Huong st...          ] ║
║                                            ║
║ 전화번호 *        │  모바일                ║
║ [093 888 5891  ] │ [                    ] ║
║                                            ║
║ 📄 광고 정보                               ║
║ ─────────────────────────────────────────║
║ 페이지 번호       │  광고 사이즈 *         ║
║ [16            ] │ [▼ FC (대형)         ] ║
║                                            ║
║ 단가 (USD) *                               ║
║ [450                                    ] ║
║                                            ║
║ 📅 계약 기간                               ║
║ ─────────────────────────────────────────║
║ 시작 호수         │  종료 호수             ║
║ [552           ] │ [557                 ] ║
║                                            ║
║ 💡 계약 기간: 6개 호 | 총 금액: $2,700    ║
║                                            ║
║ 비고                                       ║
║ [                                        ] ║
║                                            ║
║ [취소] [📋 클립보드에 복사] [⚙️ 자동추가]  ║
╚════════════════════════════════════════════╝
```

---

## 🔄 전체 프로세스

### 방법 A (클립보드)
```
1. ➕ 버튼 클릭
   ↓
2. 폼 작성
   ↓
3. 📋 클립보드에 복사
   ↓
4. Google Sheets 열기
   ↓
5. 마지막 행 선택
   ↓
6. Ctrl + V
   ↓
7. 번호 입력
   ↓
8. 앱 새로고침
   ↓
9. ✅ 완료!
```

### 방법 B (자동)
```
1. Apps Script 설정 (처음 한 번만)
   ↓
2. ➕ 버튼 클릭
   ↓
3. 폼 작성
   ↓
4. ⚙️ 자동 추가
   ↓
5. 3-5초 대기
   ↓
6. 앱 새로고침
   ↓
7. ✅ 완료!
```

**소요 시간:**
- 방법 A: 약 2분
- 방법 B: 약 30초 (설정 후)

---

## 🚨 문제 해결

### ❓ "복사되었습니다" 메시지가 안 나타나요
**원인:** 브라우저 클립보드 권한  
**해결:** 브라우저 설정에서 클립보드 권한 허용

### ❓ 붙여넣기했는데 데이터가 이상해요
**원인:** 잘못된 셀에 붙여넣기  
**해결:** A 컬럼(No.)부터 시작하는 빈 행에 붙여넣기

### ❓ 앱을 새로고침해도 새 고객이 안 보여요
**원인:** Google Sheets가 업데이트되지 않음  
**해결:** 
1. Google Sheets 확인 (실제로 추가되었는지)
2. 시트가 "공개" 설정인지 확인
3. 브라우저 캐시 삭제 후 재시도

### ❓ 자동 추가가 안 돼요
**원인:** Apps Script URL 미설정 또는 잘못된 URL  
**해결:**
1. AddCustomerForm.js에 URL이 설정되었는지 확인
2. Apps Script가 "웹 앱"으로 배포되었는지 확인
3. 권한이 "모든 사용자"로 설정되었는지 확인

### ❓ "단가는 0보다 커야 합니다" 에러
**원인:** 단가를 입력하지 않았거나 0 입력  
**해결:** 양수 금액 입력 (예: 450)

---

## 📞 추가 지원

- 📄 `고객카드_사용방법.md` - 고객 카드 가이드
- 📄 `시트채우기_사용방법.md` - 일괄 채우기 가이드
- 📄 `README_데이터변환가이드.md` - 전체 가이드

---

## 🎬 빠른 시작 (30초)

```bash
# 방법 A (클립보드)
1. ➕ 버튼 클릭
2. 필수 항목만 입력
3. 📋 복사
4. Sheets에 붙여넣기

# 완료! 🎉
```

**💾 새 고객을 빠르게 추가하고 효율적으로 관리하세요!**
