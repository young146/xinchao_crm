# 📅 발행 일정 관리 시스템

## 🎯 시스템 개요

Xinchao Vietnam CRM의 발행 일정 관리 시스템은 **호수(Vol)와 실제 발행 날짜를 연결**하여 계약 기간, 계약 상태, 결제 패턴을 정확하게 계산합니다.

```
Vol 553 = 2026.02.05 (발행됨)
Vol 554 = 2026.02.20 (예정)
       ↓
계약 기간 자동 계산
계약 상태 자동 판정
결제 패턴 자동 분석
```

---

## ✨ 주요 기능

### 1. 📅 발행 일정 관리
- **호수별 발행 날짜 매핑**
- **격주 vs 3주 발행 주기 구분**
- **현재/다음 발행 자동 계산**
- **월별 일정 캘린더**

### 2. ⚙️ UI 편집 기능
- **대시보드에서 직접 추가/수정/삭제**
- **파일 수정 불필요**
- **즉시 저장 & 자동 반영**
- **백업 & 복원**

### 3. 🔄 자동 적용
- **현재 볼륨 자동 계산**
- **계약 상태 자동 판정**
- **고객 카드 날짜 자동 표시**
- **전체 시스템 동기화**

---

## 📦 시스템 구성

### 컴포넌트
```
src/components/
├── VolumeSchedule.js        - 발행 일정 보기 UI
├── VolumeScheduleEditor.js  - 발행 일정 편집 UI
├── CustomerCard.js          - 고객 카드 (날짜 표시)
└── App.js                   - 메인 대시보드
```

### 유틸리티
```
src/utils/
├── volumeSchedule.js        - 발행 일정 로직
└── contractStatus.js        - 계약 상태 판정
```

### 가이드 문서
```
발행일정_관리방법.md          - 전체 시스템 설명
발행일정_치트시트.md          - 빠른 참고 가이드
발행일정_단일업데이트_설명.md - 자동 적용 원리
발행일정_연결구조.md          - 코드 연결 구조
발행일정_UI편집_사용방법.md   - UI 편집 상세 가이드
발행일정_UI편집_치트시트.md   - UI 편집 빠른 참조
```

---

## 🚀 사용 방법

### 방법 1: UI로 편집 (권장)

```
1. 대시보드 → "📅 발행 일정" 탭
2. "⚙️ 일정 편집 모드" 클릭
3. 추가/수정/삭제
4. 자동 저장 ✅
5. 모든 곳에 자동 반영 ✅
```

**상세 가이드**: `발행일정_UI편집_사용방법.md`

---

### 방법 2: 파일로 편집 (고급 사용자)

```javascript
// src/utils/volumeSchedule.js

const DEFAULT_VOLUME_SCHEDULE = {
  554: { date: "2026-02-20", status: "published" }, // ← 수정
  555: { date: "2026-03-05", status: "planned" },
};
```

**상세 가이드**: `발행일정_관리방법.md`

---

## 📊 데이터 흐름

### 저장 구조
```
┌─────────────────────────────────────┐
│ DEFAULT_VOLUME_SCHEDULE             │
│ (volumeSchedule.js - 기본값)        │
└─────────────┬───────────────────────┘
              │
              │ + (병합)
              │
┌─────────────┴───────────────────────┐
│ localStorage: volumeSchedule        │
│ (사용자 설정)                       │
└─────────────┬───────────────────────┘
              │
              │ = (최종 결과)
              │
┌─────────────┴───────────────────────┐
│ VOLUME_SCHEDULE                     │
│ (실제 사용되는 일정)                │
└─────────────────────────────────────┘
```

### 자동 적용 흐름
```
volumeSchedule.js
       ↓ import
contractStatus.js
       ↓ import
┌──────┴───────┬──────────┬──────────┐
│              │          │          │
CustomerCard   App.js    VolumeSchedule
(날짜 표시)    (상태)    (일정 UI)
       ↓          ↓          ↓
   자동 업데이트  자동 판정  자동 표시
```

---

## 🎨 UI 화면

### 1. 발행 일정 보기
```
┌──────────────────┬──────────────────┐
│ 📖 현재 발행 중  │ 📆 다음 발행 예정│
│                  │                  │
│   Vol 553        │   Vol 554        │
│ 2026년 2월 5일   │   15일 후       │
└──────────────────┴──────────────────┘

[1월] [2월] [3월] [4월] ...
       ^^^

┌────────────┬────────────┬────────────┐
│ Vol 553 ✓  │ Vol 554    │            │
│ 발행됨     │ 예정       │            │
│ 2026.02.05 │ 2026.02.20 │            │
│ 📆 격주    │ 📆 격주    │            │
└────────────┴────────────┴────────────┘
```

### 2. 발행 일정 편집
```
┌─────────────────────────────────────┐
│ ⚙️ 발행 일정 관리                   │
│                [📥내보내기][📤가져오기][🔄초기화] │
├─────────────────────────────────────┤
│ ➕ 새 호수 추가                      │
│ [호수:555][날짜:2026-03-05][상태:예정▼][➕추가] │
├─────────────────────────────────────┤
│ 📋 발행 일정 목록                    │
│ ┌─────┬──────────┬─────┬──────┬───┐│
│ │호수 │발행 날짜 │상태 │간격  │작업││
│ ├─────┼──────────┼─────┼──────┼───┤│
│ │553  │2026.02.05│발행 │16일  │[✏️]││
│ │554  │2026.02.20│예정 │15일  │[✓]││
│ └─────┴──────────┴─────┴──────┴───┘│
└─────────────────────────────────────┘
```

### 3. 고객 카드 - 계약 날짜
```
╔═══════════════════════════════════╗
║ 📄 계약 정보                      ║
║ ─────────────────────────────────║
║ 시작 (호수): Vol 552              ║
║ 종료 (호수): Vol 557              ║
║ 📅 시작 날짜: 2026.01.20          ║
║ 📅 종료 날짜: 2026.04.02          ║
║ 계약 기간: 6개 호 (약 2개월)     ║
║                                   ║
║ 📊 호수별 광고 현황               ║
║ ┌────────┐ ┌────────┐ ┌────────┐║
║ │Vol 552 │ │Vol 553 │ │Vol 554 │║
║ │ ✓발행  │ │ ✓발행  │ │  예정  │║
║ │01.20   │ │02.05   │ │02.20   │║
║ └────────┘ └────────┘ └────────┘║
║                                   ║
║ 💡 총 6개 호                      ║
║ 📅 2026.01.20 ~ 04.02 (약 2개월) ║
╚═══════════════════════════════════╝
```

---

## 📋 주요 함수

### volumeSchedule.js

#### `VOLUME_SCHEDULE`
```javascript
// 기본 일정 + 사용자 설정 병합
export const VOLUME_SCHEDULE = {
  553: { date: "2026-02-05", status: "published" },
  554: { date: "2026-02-20", status: "planned" },
  // ...
};
```

#### `getCurrentVolume()`
```javascript
// 오늘 날짜 기준으로 현재 발행 중인 볼륨 자동 계산
const currentVol = getCurrentVolume();
// 결과: 553 (2026.02.16 기준)
```

#### `getContractDates(startVol, endVol)`
```javascript
// 계약 호수를 날짜로 변환
const dates = getContractDates(552, 557);
// 결과: {
//   startDate: 2026-01-20,
//   endDate: 2026-04-02,
//   duration: 73일
// }
```

#### `getVolumeRangeDates(startVol, endVol)`
```javascript
// 호수별 발행일 배열
const dates = getVolumeRangeDates(552, 557);
// 결과: [
//   { volume: 552, date: "2026-01-20", dateString: "2026.01.20", status: "published" },
//   { volume: 553, date: "2026-02-05", dateString: "2026.02.05", status: "published" },
//   ...
// ]
```

#### `getLatestSchedule()`
```javascript
// 최신 일정 가져오기 (localStorage 포함)
const schedule = getLatestSchedule();
// 결과: 기본 일정 + 사용자 설정 병합된 객체
```

---

## 🔄 업데이트 시나리오

### 시나리오: Vol 554 발행 (2026.02.20)

#### 방법 1: UI 편집 (권장)
```
1. "📅 발행 일정" → "⚙️ 일정 편집 모드"
2. Vol 554 찾기
3. "✓ 발행" 버튼 클릭
4. ✅ 완료!
```

#### 방법 2: 파일 편집
```javascript
// src/utils/volumeSchedule.js

// 수정 전
554: { date: "2026-02-20", status: "planned" },

// 수정 후
554: { date: "2026-02-20", status: "published" },
```

#### 자동 적용 결과
```
✅ contractStatus.js
   CURRENT_VOLUME: 553 → 554 (자동)

✅ 대시보드
   - 현재 Vol: 554
   - "광고 게재 중": 자동 재계산
   - "계약 만료": 자동 증가

✅ 고객 카드 (Vol 549~554)
   - 상태: "계약 만료"
   - 종료 날짜: 2026.02.20
   - Vol 554: ✓ 표시

✅ 고객 카드 (Vol 552~557)
   - 상태: "광고 게재 중"
   - 남은 호수: 4개
   - Vol 554: ✓ 표시

✅ 결제 패턴
   - 발행 호수: 자동 증가
   - 기대 수금: 자동 재계산
   - 선불/지연 판정: 자동 업데이트
```

---

## 💾 데이터 저장

### localStorage 구조
```json
{
  "volumeSchedule": {
    "554": {
      "date": "2026-02-20",
      "status": "published"
    },
    "555": {
      "date": "2026-03-05",
      "status": "planned"
    }
  }
}
```

### 백업 파일 (JSON)
```json
{
  "553": { "date": "2026-02-05", "status": "published" },
  "554": { "date": "2026-02-20", "status": "published" },
  "555": { "date": "2026-03-05", "status": "planned" },
  ...
}
```

---

## ⚠️ 주의사항

### 1. 브라우저 데이터
```
✅ localStorage 사용 (브라우저에 저장)
⚠️ 브라우저 캐시 삭제 시 데이터 손실
💡 정기적인 백업 권장 (매주 내보내기)
```

### 2. 데이터 우선순위
```
사용자 설정 (localStorage)
       ↓ 우선
기본 일정 (volumeSchedule.js)
```

### 3. 현재 볼륨 계산
```
✅ 오늘 날짜 기준 자동 계산
⚠️ status가 "published"인 호수만 계산
💡 새 호 발행 시 status를 "발행됨"으로 변경
```

---

## 🔧 트러블슈팅

### 문제: 변경사항이 반영 안 됨
```
해결: F5 (페이지 새로고침)
```

### 문제: 현재 볼륨이 이상함
```
해결:
1. 발행된 호수의 status 확인 ("published")
2. 날짜가 오늘 이전인지 확인
3. 브라우저 시간 확인
```

### 문제: 데이터가 사라짐
```
해결:
1. 백업 파일 확인
2. "📤 가져오기"로 복원
3. 없으면 수동 재입력
```

---

## 📚 관련 문서

### 초보자용
1. **발행일정_치트시트.md** - 빠른 참조
2. **발행일정_UI편집_치트시트.md** - UI 편집 빠른 참조

### 일반 사용자용
3. **발행일정_관리방법.md** - 전체 시스템 설명
4. **발행일정_UI편집_사용방법.md** - UI 편집 상세 가이드

### 개발자용
5. **발행일정_단일업데이트_설명.md** - 자동 적용 원리
6. **발행일정_연결구조.md** - 코드 연결 구조

---

## 🎯 주요 특징

### 1. Single Source of Truth
```
volumeSchedule.js = 유일한 데이터 원본
모든 파일이 이것을 참조
데이터 일관성 보장
```

### 2. Don't Repeat Yourself
```
날짜 계산 로직이 1곳에만 존재
수정 시 1곳만 변경
버그 가능성 최소화
```

### 3. Automatic Propagation
```
데이터 변경
   ↓
import 체인을 통해 자동 전파
   ↓
모든 컴포넌트 자동 업데이트
```

---

## 💡 Best Practices

### 1. 정기적인 백업
```
매주 금요일:
- "📥 내보내기" 클릭
- JSON 파일 안전한 곳에 보관
```

### 2. 상태 관리
```
발행 후:
- 즉시 status를 "발행됨"으로 변경
- 대시보드에서 확인
```

### 3. 일관성 유지
```
날짜 입력 시:
- 격주 발행: 14~16일 간격
- 3주 발행: 18~21일 간격
- 휴일 고려
```

---

## 🚀 시작하기

### 1. 첫 사용
```
1. 대시보드 접속
2. "📅 발행 일정" 탭 확인
3. 기본 일정 검토
4. 필요 시 "⚙️ 일정 편집 모드"에서 수정
```

### 2. 일상적인 사용
```
새 호 발행 시:
1. "📅 발행 일정" → "⚙️ 일정 편집 모드"
2. 해당 호수 찾기
3. "✓ 발행" 버튼 클릭
4. 완료!
```

### 3. 대량 추가
```
하반기 일정 추가 시:
1. "⚙️ 일정 편집 모드"
2. "새 호수 추가"에서 반복 입력
3. 또는 파일 편집 후 가져오기
```

---

## 📞 추가 지원

- **기본 사용법**: `발행일정_치트시트.md`
- **UI 편집**: `발행일정_UI편집_사용방법.md`
- **시스템 이해**: `발행일정_단일업데이트_설명.md`
- **코드 구조**: `발행일정_연결구조.md`

---

**💡 파일 수정 없이 UI로 쉽게 발행 일정을 관리하세요!**
